<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Spatial patterns with a single variable</title>
    <meta name="description"
          content="In this post, we’re about to discuss dominant spatial patterns formally.">

    <link rel="icon" type="image/png" href="
    /assets/images/favicons/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="
    /assets/images/favicons/android-chrome-512x512.png" sizes="512x512">
    <link rel="icon" type="image/png" href="
    /assets/images/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="
    /assets/images/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="apple-touch-icon" href="
    /assets/images/favicons/apple-touch-icon.png">
    <link rel="stylesheet" href="
    /css/main.css">
    <link rel="stylesheet" href="
    /css/syntax-style.css">
    <link rel="stylesheet" href="
    /css/site.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="canonical" href="http://localhost:4000/2017/06/17/spatial_patterns_with_a_single_variable.html">
    <link rel="alternate" type="application/rss+xml" title="Joseph Wang's Blog" href="http://localhost:4000
    /feed.xml" />

    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } });
    </script>
    <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             processEscapes: true
           }
         });

    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
            type="text/javascript"></script>
    <script type="text/javascript" src="
    /js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="
    /js/jq_mathjax_parse.js"></script>
    <script type="text/javascript" src="
    /js/jquery.toc.min.js"></script>

    
</head>


<body>

<header class="site-header">

    <div class="wrapper">

        <a class="site-title" href="/">Joseph Wang's Blog</a>

        <nav class="site-nav">
            <a href="#" class="menu-icon">
                <svg viewBox="0 0 18 15">
                    <path fill="#424242"
                          d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242"
                          d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242"
                          d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </a>

            <div class="trigger">
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <a class="page-link" href="/about/">About</a>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <a class="page-link" href="/tags/software/">Software</a>
            </div>
        </nav>

    </div>

</header>


<div class="page-content">
    <div class="wrapper">
        


<div class="post">

    <header class="post-header">
        <h1 class="post-title">Spatial patterns with a single variable</h1>
        <p class="post-meta">Jun 17, 2017</p>
        <p id="post-meta"><i
        class="fa fa-tags"></i>: <a href="/tags/Statistics/">Statistics</a>, <a href="/tags/Spatial Statistics/">Spatial Statistics</a></p>
    </header>

    <article class="post-content">
        <p>In this post, we’re about to discuss dominant spatial patterns formally.</p>

<h2 id="whats-a-spatial-pattern">What’s a spatial pattern?</h2>

<p>In climate researches, it is common to apply dominant spatial patterns to interpret physical phenomenon and spatial variation of a climate variable, e.g., sea surface temperature.</p>

<p>For example, there are two major spatial patters (mode) of sea surface temperature in the Indian Ocean. That is, a basin model (top panel) and a dipole model (bottom panel) in the following graph.</p>

<center>
  <img src="http://localhost:4000/assets/spatial_patterns_with_a_single_variable/spatpcak1_t.png" width="60%" height="40%" />
  <div class="caption">Basin mode</div>
  <img src="http://localhost:4000/assets/spatial_patterns_with_a_single_variable/spatpcak2_t.png" width="60%" height="40%" />
  <div class="caption">Dipole mode</div>

  <img src="http://localhost:4000/assets/spatial_patterns_with_a_single_variable/bar.png" width="60%" height="40%" />
</center>

<p>A basin-wide mode indicates that there is a sub-region with a u-shaped hole in the pattern, and means the spatial variation in this sub-region is clearly decreasing downside (or increasing upside). An east-west dipole mode illustrates that the variation of sea surface temperature in the eastern region is opposite to the one in the wester region. In other words, while the sea surface temperature in the eastern Indian Ocean becomes higher, the temperature in the western Indian Ocean more likely becomes lower. It is worth to notice that the interaction between these two patterns and El Niño–Southern Oscillation (ENSO) is a popular topic in the climate field.</p>

<h2 id="formalize-spatial-patterns-mathematically">Formalize spatial patterns mathematically</h2>

<h3 id="spatial-process-of-interest">Spatial process of interest</h3>

<p>Suppose that a spatial process of interest is \(\{\eta_i(\cdot); i = 1,\dots, n\}\) which is on a region $D \subset \mathbb{R}^d$, and at $n$ different time points. For simplicity, we assume that $\eta_i$’s are mean zero, mutally uncorrelated with common covariance function.</p>

<p>For example, we are interested in studying sea surface temperature monthly anomalies in the Indian Ocean during Jan., 2010 to Dec. 2016, formally. Then, we can define $\eta_i(\cdot)$ as a sea surface temperature monthly anomaly, $D$ as Indian Ocean (with blue color in the following plot), $n = 12\times 7$.</p>
<center>
 <img src="/assets/spatial_patterns_with_a_single_variable/process_example.png" width="60%" height="40%" />
  <div class="caption">A spatial process in the Indian Ocean</div>
</center>

<h3 id="observed-data">Observed data</h3>

<p>We only observe data at $p$ locations, say $s_1, \dots, s_p$. The observed data are defined as
\(Y_i(s_j) = \eta_i(s_j) + \epsilon_{ij},\)
where $\epsilon_{ij}$ is supposed to be a white noise with mean zero and covariance $\sigma^2$ for $i =1,\dots,n$, $j = 1, \dots,p$.</p>

<p>The graph below indicates that the observation at some cell, where the size of cells depends on the resolution of measurement. By the way, the gray color represent the land, and the observation here is usually define as $NA$ in datasets.</p>
<center>
 <img src="http://localhost:4000/assets/spatial_patterns_with_a_single_variable/data_example.png" width="60%" height="40%" />
  <div class="caption">Observed data in the Indian Ocean</div>
</center>

<p>We can rewrite our data as a matrix form. Namely, $\textbf{Y} = (\textbf{Y}_1, \dots, \textbf{Y}_n)’$ is an $n\times p$ matrix where, at each time point, we vectorize our observations over $p$ locations as $\textbf{Y}_i = (Y_i(s_1), \dots,Y_i(s_p))’$, $i = 1, \dots n$.</p>

<h3 id="spatial-patterns-via-principal-component-analysis">Spatial patterns via principal component analysis</h3>

<p>We assume that $\textbf{Y}\sim(\textbf{0}, \Sigma)$. The idea of principal component analysis (PCA) is to find a direction,  $\bf{\phi}\in \mathbb{R}^{p\times 1}$, where the variance of $\textbf{Y}_i$ projecting onto $\bf{\phi}$ is maximum. Following the same idea, we can successively find the second $\bf{\phi}$, the third $\bf{\phi}$, and so on. These $\bf{\phi}$’s are subject to orthogonal. Alternatively, we can directly obtain $\bf{\phi}$’s by the eigen-decomposition of $\Sigma = \Phi’\Lambda\Phi$ where $\Phi = (\phi_1, \dots, \phi_p)’$ is a $p\times p$ matrix, and $\Lambda = \text{diag}(\lambda_1, \dots, \lambda_p)$ with nonnegative eigenvalues $\lambda_1\geq  \dots\geq \lambda_p\geq 0$. Therefore, we can define the first $\bf{\phi}_1,\dots, \bf{\phi}_K$ with the corresponding largest eigenvalues as dominant spatial patterns. In practice, $\Sigma$ is unknown, and usually estimated by 
a sample covariance $\textbf{S} = \textbf{Y}’\textbf{Y}/n$. The estimates of $\bf{\phi}_1,\dots, \bf{\phi}_K$ are the first $K$ eigenvector of $\textbf{S}$, $\tilde{\bf{\phi}}_1,\dots, \tilde{\bf{\phi}}_K$.</p>

<p>In some fields, the patterns found by PCA are also called empirical orthogonal functions (EOF). In many situations, e.g. irregular-location data, we would like to have a functional form of pattern via a PCA estimate so there are a bunch of two-stage methods to interpolate the PCA estimates.</p>

<h2 id="references">References</h2>

<ul>
  <li>Wang and Huang (2017). <a href="http://www.tandfonline.com/doi/full/10.1080/10618600.2016.1157483&quot;">Regularized Principal Component Analysis for Spatial Data</a>.</li>
</ul>



        <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'egpivo';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments
    powered by Disqus.</a></noscript>

    </article>

</div>

    </div>
</div>

<footer class="site-footer">

    <div class="wrapper">

        <div class="footer-col  footer-col-1">
            <ul class="social-media-list">
                <li>
                    <i class="fa fa-envelope"></i>
                    <a href="mailto:egpivo@gmail.com">egpivo@gmail.com</a>
                </li>
                
                <li>
                    <i class="fa fa-github"></i>
                    <a href="https://github.com/egpivo"><span class="username">egpivo</span></a>
                </li>
                
                <li>
                    <i class="fa fa-linkedin"></i>
                    <a href="https://www.linkedin.com/in/wtwang/"><span class="username">wtwang</span></a>
                </li>
            </ul>
        </div>

        <div class="footer-col  footer-col-23">
            <p class="text">Science is a means whereby learning is achieved.
</p>
        </div>
    </div>
    </div>

</footer>


</body>

</html>
